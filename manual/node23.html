<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<!--Converted with LaTeX2HTML 2008 (1.71)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>Interrogating a pangenome matrix</TITLE>
<META NAME="description" CONTENT="Interrogating a pangenome matrix">
<META NAME="keywords" CONTENT="manual">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META NAME="Generator" CONTENT="LaTeX2HTML v2008">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="manual.css">

<LINK REL="next" HREF="node24.html">
<LINK REL="previous" HREF="node22.html">
<LINK REL="up" HREF="node21.html">
<LINK REL="next" HREF="node24.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A NAME="tex2html390"
  HREF="node24.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next"
 SRC="/usr/share/latex2html/icons/next.png"></A> 
<A NAME="tex2html386"
  HREF="node21.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up"
 SRC="/usr/share/latex2html/icons/up.png"></A> 
<A NAME="tex2html380"
  HREF="node22.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous"
 SRC="/usr/share/latex2html/icons/prev.png"></A> 
<A NAME="tex2html388"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents"
 SRC="/usr/share/latex2html/icons/contents.png"></A>  
<BR>
<B> Next:</B> <A NAME="tex2html391"
  HREF="node24.html">Calculating cloud, shell and</A>
<B> Up:</B> <A NAME="tex2html387"
  HREF="node21.html">Performing genome composition analyses</A>
<B> Previous:</B> <A NAME="tex2html381"
  HREF="node22.html">Obtaining a pangenome matrix</A>
 &nbsp; <B>  <A NAME="tex2html389"
  HREF="node1.html">Contents</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H3><A NAME="SECTION00058200000000000000"></A><A NAME="pangeplot"></A>
<BR>
Interrogating a pangenome matrix
</H3>

<P>
Script <SPAN  CLASS="textit">parse_pangenome_matrix.pl</SPAN> can be used to analyze a pangenome matrix, 
such as that created in the previous section.
It was primarily designed to identify genes present in a group A of species which are absent in another 
group B, but can also be used to find expansions/contractions of gene families. 
If you require the genes present/expanded in B with respect to A, just reverse them.
Expanded clusters are defined as those where all A taxa contain more sequences than the maximum 
number of corresponding sequences in any taxa of group B.  

<P>
We now review these features with the same plasmid set of previous sections, analyzing the pangenome matrix
produced by intersecting several cluster sets on section <A HREF="node22.html#pange">4.8.1</A>.
Let's say we are interested 
in finding plasmid genes present in <SPAN  CLASS="textit">Klebsiella oxytoca</SPAN> which are not encoded in <SPAN  CLASS="textit">K.pneumoniae KP96</SPAN>.
In order to do this we first create a couple of text files to define sets A and B, 
called <code>A.txt</code> and <code>B.txt</code>, which we place inside folder <code>sample_plasmids_gbk</code>.
The content of A and B files should be one line per species. In this example file
<code>A.txt</code> contains a single line:
<code>K_oxytoca_plasmid_pKOX105.gb</code>
As well as <code>B.txt</code>:
<code>K_pneumoniae_KP96_plasmid_pKP96.gb</code>
We can now execute the script as follows:
<BR><PRE>
./parse_pangenome_matrix.pl -m sample_intersection/pangenome_matrix_t0.tab \
-A sample_plasmids_gbk/A.txt -B sample_plasmids_gbk/B.txt -g
</PRE>

<P>
The output should be:
<PRE>
# matrix contains 180 clusters and 12 taxa

# taxa included in group A = 1

# taxa included in group B = 1

# finding genes present in A which are absent in B ...
# file with genes present in set A and absent in B (21): [...]pangenome_matrix_t0__pangenes_list.txt
</PRE>

<P>
It can be seen that 21 genes were found to be present in A and absent in B.
In the case of pangenome matrices derived from GenBank files, as in this example, it is possible to 
produce a map of these genes in the genomic context of any species included in A, which should be queried using 
option <code>-l</code>. A valid syntax would be:
<PRE>
./parse_pangenome_matrix.pl -m sample_intersection/pangenome_matrix_t0.tab \
-A sample_plasmids_gbk/A.txt -B sample_plasmids_gbk/B.txt -g \
-p 'Klebsiella oxytoca KOX105'
</PRE>

<P>

<DIV ALIGN="CENTER"><A NAME="fig:pangemat"></A><A NAME="501"></A>
<TABLE>
<CAPTION ALIGN="BOTTOM"><STRONG>Figure 11:</STRONG>
Map of plasmid OX105 highlighting 7 genes absent in pKP96.</CAPTION>
<TR><TD>
<DIV ALIGN="CENTER">
<IMG
  WIDTH="1064" HEIGHT="97" ALIGN="BOTTOM" BORDER="0"
 SRC="./sample_pangenome_AB.png"
 ALT="Image sample_pangenome_AB">

</DIV></TD></TR>
</TABLE>
</DIV>

<P>
By default, <SPAN  CLASS="textit">parse_pangenome_matrix.pl</SPAN> requires present genes to be present in all genomes of A and none of B.
However, as genomes might not be completelly annotated, it is possible to make these tests more flexible by controlling the cutoff for inclusion,
by using flag <code>-P</code>. For instance, the next command will require genes to be present only in 90% of A genomes and missing in 90% of B genomes:
<PRE>
./parse_pangenome_matrix.pl -m sample_intersection/pangenome_matrix_t0.tab \
-A sample_plasmids_gbk/A.txt -B sample_plasmids_gbk/B.txt -g -P 90
</PRE> 

<P>
Note that the most flexible way of finding out genes absent in a set of genomes within a pangenome matrix is by using option <code>-a</code>, 
which does not require an A list, rather a B list is sufficient. It is called as in the example:
<PRE>
./parse_pangenome_matrix.pl -m sample_intersection/pangenome_matrix_t0.tab \
-B sample_plasmids_gbk/B.txt -a
</PRE> 

<P>

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A NAME="tex2html390"
  HREF="node24.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next"
 SRC="/usr/share/latex2html/icons/next.png"></A> 
<A NAME="tex2html386"
  HREF="node21.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up"
 SRC="/usr/share/latex2html/icons/up.png"></A> 
<A NAME="tex2html380"
  HREF="node22.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous"
 SRC="/usr/share/latex2html/icons/prev.png"></A> 
<A NAME="tex2html388"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents"
 SRC="/usr/share/latex2html/icons/contents.png"></A>  
<BR>
<B> Next:</B> <A NAME="tex2html391"
  HREF="node24.html">Calculating cloud, shell and</A>
<B> Up:</B> <A NAME="tex2html387"
  HREF="node21.html">Performing genome composition analyses</A>
<B> Previous:</B> <A NAME="tex2html381"
  HREF="node22.html">Obtaining a pangenome matrix</A>
 &nbsp; <B>  <A NAME="tex2html389"
  HREF="node1.html">Contents</A></B> </DIV>
<!--End of Navigation Panel-->
<ADDRESS>
Bruno Contreras Moreira
2016-04-28
</ADDRESS>
</BODY>
</HTML>
